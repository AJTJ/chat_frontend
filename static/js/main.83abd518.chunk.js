(this.webpackJsonpchat_socket=this.webpackJsonpchat_socket||[]).push([[0],{29:function(n,e,t){"use strict";t.r(e);var o,i,c,r,s,d,a,l,u,p,h,j,b,x,g,f,O,v,m,S,_,w=t(1),E=t.n(w),R=t(16),T=t.n(R),D=t(5),C=t(2),y=t(3),P=t(17),A=t.n(P),k=t(8),L=t(18),M=t(0),N=["400","600","800","1060"],U=N.map((function(n){return"@media (max-width: ".concat(n,"px)")})),F=(N.map((function(n){return"@media (min-width: ".concat(n,"px)")})),Object(L.a)(["@media(max-width: ".concat(N[3],"px)"),"@media(max-width: ".concat(N[2],"px)"),"@media(max-width: ".concat(N[1],"px)"),"@media(max-width: ".concat(N[0],"px)")]),{colors:{color1:"#b7410e",color2:"#f4f7be",color2Lighter:"rgba(244, 247, 191, 0.61)",color3:"#e5f77d",color4:"#deba6f",color5:"#1e000e"}}),I=function(){return Object(M.jsx)(k.a,{styles:function(n){return Object(k.b)(o||(o=Object(C.a)(['\n      * {\n        box-sizing: border-box;\n      }\n      html {\n        height: 100%;\n      }\n      body {\n        font-family: "Lato", sans-serif;\n        margin: 0;\n        padding: 0;\n        a {\n          text-decoration: none;\n          color: ',";\n        }\n      }\n    "])),(function(n){return n.theme.colors.color_1}))}})},W=y.a.div(i||(i=Object(C.a)(["\n  padding: 5px 5px;\n  /* background: ","; */\n"])),(function(n){return n.indexNum%2===0?n.theme.colors.color2Lighter:"none"})),z=y.a.span(c||(c=Object(C.a)(["\n  color: ",";\n  padding-right: 15px;\n  font-weight: ",";\n  font-size: 12px;\n"])),(function(n){return n.isYou&&n.theme.colors.color1}),(function(n){return n.isYou?"bolder":"bold"})),H=y.a.span(r||(r=Object(C.a)(["\n  color: ",";\n  font-size: 11px;\n"])),(function(n){return n.theme.colors.color4})),K=y.a.div(s||(s=Object(C.a)(["\n  padding: 0 0 5px;\n  font-size: 12px;\n"]))),V=y.a.form(d||(d=Object(C.a)(["\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  height: 60px;\n  margin: 0;\n  padding: 10px 0 0;\n  background: ",";\n"])),(function(n){return n.theme.colors.color2})),Y=y.a.input(a||(a=Object(C.a)(["\n  width: calc(100% - 6px);\n  background: white;\n  border-radius: 3px;\n  padding: 10px 3px;\n  resize: none;\n  margin: 0 3px;\n"]))),J=y.a.div(l||(l=Object(C.a)(["\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  background: ",";\n"])),(function(n){return n.theme.colors.color2})),B=y.a.div(u||(u=Object(C.a)(["\n  display: flex;\n  border: 1px solid ",";\n  border-radius: 3px;\n  /* padding: 0 5px 0; */\n  margin: 0 5px;\n  background: white;\n  height: calc(100vh - 60px - 90px);\n"])),(function(n){return n.theme.colors.color1})),G=y.a.div(p||(p=Object(C.a)(["\n  width: calc(100% - 120px);\n  /* overflow: scroll; */\n  overflow-y: scroll;\n  display: flex;\n  flex-direction: column-reverse;\n  flex-grow: 1;\n"]))),q=y.a.div(h||(h=Object(C.a)(["\n  width: 120px;\n  padding-left: 10px;\n  overflow: hidden;\n  border-left: "," 1px solid;\n  "," {\n    width: 75px;\n    font-size: 10px;\n  }\n"])),(function(n){return n.theme.colors.color4}),U[2]),Q=y.a.div(j||(j=Object(C.a)(["\n  padding-top: 5px;\n  padding-bottom: 50px;\n  overflow-y: scroll;\n  /* overflow-x: hidden; */\n  height: 100%;\n  /* max-height: calc(100vh - 60px - 250px); */\n"]))),X=y.a.div(b||(b=Object(C.a)(["\n  font-size: 12px;\n  font-weight: ",";\n  /* text-decoration: ","; */\n  "," {\n    /* width: 75px; */\n    font-size: 10px;\n  }\n"])),(function(n){return n.isYou?"bold":"normal"}),(function(n){return n.isYou&&"underline"}),U[2]),Z=function(n){var e=n.ws,t=n.reconnectingMsg,o=n.allMessages,i=n.allUsers,c=n.signedInUser,r=Object(w.useState)(""),s=Object(D.a)(r,2),d=s[0],a=s[1];return Object(M.jsx)(J,{children:Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)(B,{children:[Object(M.jsx)(G,{children:(null===o||void 0===o?void 0:o.length)?null===o||void 0===o?void 0:o.map((function(n,e){var t=A.a.utc(null===n||void 0===n?void 0:n.time).local().format("h:mm:ss a, D MMM YY");return Object(M.jsx)(W,{indexNum:e,children:Object(M.jsxs)("div",{children:[Object(M.jsx)(z,{isYou:(null===n||void 0===n?void 0:n.name)===c,children:null===n||void 0===n?void 0:n.name}),Object(M.jsx)(H,{children:t}),Object(M.jsx)(K,{children:null===n||void 0===n?void 0:n.message})]},(null===n||void 0===n?void 0:n.time)+(null===n||void 0===n?void 0:n.message))},(null===n||void 0===n?void 0:n.message)+e+(null===n||void 0===n?void 0:n.time))})):t&&Object(M.jsxs)(W,{children:[Object(M.jsx)(z,{children:"From the server"}),Object(M.jsx)(K,{children:t})]})}),Object(M.jsx)(q,{children:Object(M.jsx)(Q,{children:c&&!(null===i||void 0===i?void 0:i.length)?Object(M.jsx)(X,{children:"...Nobody here"}):c||(null===i||void 0===i?void 0:i.length)?Object(M.jsx)(M.Fragment,{children:i.map((function(n,e){return Object(M.jsx)(X,{isYou:n===c,children:n===c?"\u2b50\ufe0f  ".concat(n):n},e+n)}))}):Object(M.jsx)(X,{children:"Please Login"})})})]}),Object(M.jsx)(V,{onSubmit:function(n){var t,o;n.preventDefault();var i=JSON.stringify({message:d});(null===e||void 0===e||null===(t=e.current)||void 0===t?void 0:t.send)&&(null===e||void 0===e||null===(o=e.current)||void 0===o||o.send(i)),a("")},children:Object(M.jsx)(Y,{onChange:function(n){a(n.target.value)},placeholder:"write a message",value:d})})]})})},$=y.a.div(x||(x=Object(C.a)(["\n  color: ",";\n  font-size: 25px;\n  font-weight: bolder;\n  background: ",";\n  text-align: center;\n  /* padding: 10px 0; */\n  height: 40px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])),(function(n){return n.theme.colors.color1}),(function(n){return n.theme.colors.color2})),nn=y.a.div(g||(g=Object(C.a)(["\n  width: 100%;\n  height: 90px;\n"]))),en=y.a.div(f||(f=Object(C.a)(["\n  height: 50px;\n  background: ",';\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 10px;\n  font-size: 14px;\n\n  input[type="submit"],\n  button {\n    border-radius: 10px;\n    margin: 0 2px;\n    border: none;\n    background: ',";\n    color: ",";\n    padding: 4px 2px;\n    width: 45px;\n    font-size: 10px;\n  }\n  .alt {\n    background: ",";\n    color: ",";\n  }\n  "," {\n    flex-direction: column;\n    justify-content: space-between;\n    padding: 5px 0;\n  }\n"])),(function(n){return n.theme.colors.color2}),(function(n){return n.theme.colors.color1}),(function(n){return n.theme.colors.color2}),(function(n){return n.theme.colors.color4}),(function(n){return n.theme.colors.color2}),U[2]),tn=y.a.div(O||(O=Object(C.a)(["\n  height: 15px;\n  display: flex;\n  align-items: center;\n"]))),on=y.a.div(v||(v=Object(C.a)(["\n  display: flex;\n  align-items: center;\n  height: 20px;\n"]))),cn=y.a.div(m||(m=Object(C.a)(["\n  padding-right: 10px;\n"]))),rn=y.a.form(S||(S=Object(C.a)(['\n  display: flex;\n  align-items: center;\n  input[type="text"],\n  input[type="password"] {\n    height: 28px;\n    margin-right: 5px;\n    border-radius: 5px;\n    border: 1px solid black;\n    padding: 5px;\n    /* margin-top: 2px; */\n    font-size: 12px;\n    '," {\n      font-size: 10px;\n      width: 100px;\n      height: 20px;\n    }\n  }\n"])),U[2]),sn=y.a.div(_||(_=Object(C.a)(["\n  padding-right: 5px;\n  "," {\n    width: 50px;\n    font-size: 10px;\n    text-align: right;\n  }\n"])),U[2]),dn=function(n){var e=n.ws,t=n.openSocket,o=(n.setReconnectingMsg,n.cleanUpReceived),i=(n.defaultConnectingMsg,n.signedInUser),c=(n.reconnectingMsg,n.wsMessage),r=n.setWsMessage,s=Object(w.useState)(""),d=Object(D.a)(s,2),a=d[0],l=d[1],u=Object(w.useState)(""),p=Object(D.a)(u,2),h=p[0],j=p[1],b=Object(w.useState)(!0),x=Object(D.a)(b,2),g=x[0],f=x[1],O=function(n){var t;null===e||void 0===e||null===(t=e.current)||void 0===t||t.close(),o(n)},v=function(){m(),O(),t()},m=function(){l(""),j("")};return Object(M.jsxs)(nn,{children:[Object(M.jsx)($,{children:"Rusty Chat"}),Object(M.jsxs)(en,{children:[Object(M.jsx)(tn,{children:c&&Object(M.jsx)("div",{children:c})}),Object(M.jsx)(on,{children:i?Object(M.jsxs)(M.Fragment,{children:[i&&Object(M.jsxs)(cn,{children:["Welcome, ",i]}),Object(M.jsx)("button",{onClick:function(n){n.preventDefault();fetch("http://".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/chat_frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ADDRESS:"http://127.0.0.1:8081"}).SERVER_ADDRESS,"/logout/"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(n){O({isLogout:!0})}))},children:"Log out"})]}):Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)(sn,{children:[g?"Login":"Sign Up",":"]}),Object(M.jsxs)(rn,{onSubmit:g?function(n){n.preventDefault();var e={method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({user_name:a,password:h})};fetch("http://".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/chat_frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ADDRESS:"http://127.0.0.1:8081"}).SERVER_ADDRESS,"/login/"),e).then((function(n){console.log(n),n.json().then((function(n){return r(n)})),v()})).catch((function(n){console.error("sign in error",n)}))}:function(n){n.preventDefault();var e={method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({user_name:a,password:h})};fetch("http://".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/chat_frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ADDRESS:"http://127.0.0.1:8081"}).SERVER_ADDRESS,"/signup/"),e).then((function(n){n.json().then((function(n){return r(n)})),v()}))},children:[Object(M.jsx)("input",{id:"userInput",type:"text",placeholder:"Name",autoComplete:"username",onChange:function(n){l(n.target.value)},value:a}),Object(M.jsx)("input",{id:"passwordInput",placeholder:"password",type:"password",autoComplete:g?"current-password":"new-password",onChange:function(n){j(n.target.value)},value:h}),Object(M.jsx)("input",{type:"submit",value:"Submit"})]}),Object(M.jsx)("button",{className:"alt",onClick:function(){m(),f(!g)},children:g?"Sign Up":"Login"})]})})]})]})},an=t(4),ln=function(){var n=Object(w.useState)(void 0),e=Object(D.a)(n,2),t=e[0],o=e[1],i=Object(w.useState)(void 0),c=Object(D.a)(i,2),r=c[0],s=c[1],d=Object(w.useState)([]),a=Object(D.a)(d,2),l=a[0],u=a[1],p=Object(w.useState)(void 0),h=Object(D.a)(p,2),j=h[0],b=h[1],x=Object(w.useState)([]),g=Object(D.a)(x,2),f=g[0],O=g[1],v=Object(w.useState)(void 0),m=Object(D.a)(v,2),S=m[0],_=m[1],E="Attempting to Connect",R="Please login or register",T=Object(w.useRef)(null),C=function(n){_(E),T.current=new WebSocket("ws:".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/chat_frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ADDRESS:"http://127.0.0.1:8081"}).SERVER_ADDRESS,"/ws/")),T.current&&(T.current.onopen=function(){console.log("ws opened"),s(void 0),_(void 0),(null===T||void 0===T?void 0:T.current)&&(T.current.onmessage=function(n){o(n.data)})},T.current.onclose=function(){console.log("ws closed"),r||s(R)}),_(void 0)};return Object(w.useEffect)((function(){C();var n=null===T||void 0===T?void 0:T.current;return function(){null===n||void 0===n||n.close()}}),[]),Object(w.useEffect)((function(){var n=t?JSON.parse(t):{};(null===n||void 0===n?void 0:n.all_messages)?u(JSON.parse(n.all_messages)):u([]),(null===n||void 0===n?void 0:n.message_to_client)?s(n.message_to_client):(null===n||void 0===n?void 0:n.is_update)||s(r),(null===n||void 0===n?void 0:n.user_name)?b(n.user_name):b(void 0),(null===n||void 0===n?void 0:n.all_online_users)?O(n.all_online_users):O([])}),[t]),Object(M.jsxs)("div",{children:[Object(M.jsx)(dn,{ws:T,openSocket:C,setReconnectingMsg:_,cleanUpReceived:function(n){var e=(n||{}).isLogout;o(void 0),u([]),b(void 0),O([]),s(e?R:void 0)},defaultConnectingMsg:E,reconnectingMsg:S,wsMessage:r,setWsMessage:s,signedInUser:j}),Object(M.jsx)(Z,{ws:T,reconnectingMsg:S,allMessages:l,allUsers:f,signedInUser:j})]})},un=function(){return Object(M.jsxs)(an.c,{theme:F,children:[Object(M.jsx)(I,{}),Object(M.jsx)(ln,{})]})},pn=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,30)).then((function(e){var t=e.getCLS,o=e.getFID,i=e.getFCP,c=e.getLCP,r=e.getTTFB;t(n),o(n),i(n),c(n),r(n)}))};T.a.render(Object(M.jsx)(E.a.StrictMode,{children:Object(M.jsx)(un,{})}),document.getElementById("root")),pn()}},[[29,1,2]]]);
//# sourceMappingURL=main.83abd518.chunk.js.map